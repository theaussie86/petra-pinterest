---
phase: 09-consistent-ui-dashboard-layout
plan: 03
type: execute
wave: 2
depends_on: ["09-01"]
files_modified:
  - src/routes/_authed/projects/$id.tsx
  - src/routes/_authed/pins/$pinId.tsx
  - src/routes/_authed/articles/$articleId.tsx
  - src/components/layout/header.tsx
autonomous: true

must_haves:
  truths:
    - "Project detail page uses PageLayout with maxWidth=medium and PageHeader with breadcrumbs"
    - "Pin detail page uses PageLayout with maxWidth=medium and PageHeader with breadcrumbs"
    - "Article detail page uses PageLayout with maxWidth=narrow and PageHeader with breadcrumbs"
    - "All three detail pages show breadcrumb navigation (Dashboard > [entity name])"
    - "No Header component import exists in any of the three detail routes"
    - "Header component file is deleted since no routes reference it"
    - "Loading and error states in all three pages are handled by PageLayout"
    - "All existing functionality (edit, delete, publish, metadata, scheduling) is preserved"
  artifacts:
    - path: "src/routes/_authed/projects/$id.tsx"
      provides: "Project detail with PageLayout and breadcrumbs"
      contains: "PageLayout"
    - path: "src/routes/_authed/pins/$pinId.tsx"
      provides: "Pin detail with PageLayout and breadcrumbs"
      contains: "PageLayout"
    - path: "src/routes/_authed/articles/$articleId.tsx"
      provides: "Article detail with PageLayout and breadcrumbs"
      contains: "PageLayout"
  key_links:
    - from: "src/routes/_authed/projects/$id.tsx"
      to: "src/components/layout/page-layout.tsx"
      via: "wraps content in PageLayout"
      pattern: "<PageLayout"
    - from: "src/routes/_authed/pins/$pinId.tsx"
      to: "src/components/layout/page-header.tsx"
      via: "renders breadcrumbs via PageHeader"
      pattern: "breadcrumbs=\\["
    - from: "src/routes/_authed/articles/$articleId.tsx"
      to: "src/components/layout/page-layout.tsx"
      via: "wraps content in PageLayout"
      pattern: "<PageLayout"
---

<objective>
Migrate all three detail pages (Projects, Pins, Articles) to use PageLayout and PageHeader with breadcrumb navigation, then delete the now-unused Header component.

Purpose: Completes the layout migration. Detail pages gain breadcrumb navigation for hierarchy clarity, consistent loading/error states, and standardized container widths. Removing Header eliminates dead code.

Output: 3 modified route files + 1 deleted file.
</objective>

<execution_context>
@/Users/cweissteiner/.claude/get-shit-done/workflows/execute-plan.md
@/Users/cweissteiner/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-consistent-ui-dashboard-layout/09-01-SUMMARY.md
@src/routes/_authed/projects/$id.tsx
@src/routes/_authed/pins/$pinId.tsx
@src/routes/_authed/articles/$articleId.tsx
@src/components/layout/header.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Projects and Articles detail pages to PageLayout with breadcrumbs</name>
  <files>
    src/routes/_authed/projects/$id.tsx
    src/routes/_authed/articles/$articleId.tsx
  </files>
  <action>
**Projects Detail (`src/routes/_authed/projects/$id.tsx`):**

1. Remove import of `Header` from `@/components/layout/header`
2. Remove import of `ArrowLeft` from lucide-react (breadcrumbs replace back button)
3. Add imports:
   - `PageLayout` from `@/components/layout/page-layout`
   - `PageHeader` from `@/components/layout/page-header`
4. Remove `const { user } = Route.useRouteContext()` (no longer needed)
5. Remove the 3 separate return blocks (loading, error, success) that each have their own `<div className="min-h-screen bg-slate-50"><Header user={user} /><main>` wrapper
6. Replace with a single return using PageLayout for loading/error handling:
   ```tsx
   return (
     <>
       <PageHeader
         breadcrumbs={[
           { label: "Dashboard", href: "/dashboard" },
           { label: project?.name || "Project" },
         ]}
         title={project?.name || "Project"}
         actions={
           project ? (
             <>
               <Button variant="outline" onClick={() => setEditDialogOpen(true)}>Edit</Button>
               <Button variant="outline" className="text-red-600 hover:text-red-700" onClick={() => setDeleteDialogOpen(true)}>Delete</Button>
             </>
           ) : undefined
         }
       />
       <PageLayout maxWidth="medium" isLoading={isLoading} error={error ?? null}>
         {project && (
           <>
             {/* Project metadata section */}
             {/* ... existing project content (blog URL, RSS URL, etc.) ... */}
             {/* Pinterest Connection section */}
             {/* Articles section */}
             {/* Pins section */}
           </>
         )}
       </PageLayout>
       {/* Dialogs stay outside */}
       {project && (
         <>
           <ProjectDialog ... />
           <DeleteDialog ... />
           <AddArticleDialog ... />
           <CreatePinDialog ... />
         </>
       )}
     </>
   )
   ```
7. Remove inline loading spinner and error state blocks — PageLayout handles both
8. Remove the "Back to Dashboard" ArrowLeft button — breadcrumbs provide navigation
9. Keep all existing content and functionality: metadata display, Pinterest connection, articles table, scrape button, pins list, create pin dialog
10. The edit/delete buttons move to PageHeader actions instead of being inline

**Articles Detail (`src/routes/_authed/articles/$articleId.tsx`):**

1. Remove import of `Header` from `@/components/layout/header`
2. Remove import of `ArrowLeft` from lucide-react
3. Add imports:
   - `PageLayout` from `@/components/layout/page-layout`
   - `PageHeader` from `@/components/layout/page-header`
4. Remove `const { user } = Route.useRouteContext()`
5. Remove the 2 separate return blocks (loading, error) with `<div className="min-h-screen bg-slate-50"><Header />` wrappers
6. Replace with single return:
   ```tsx
   return (
     <>
       <PageHeader
         breadcrumbs={[
           { label: "Dashboard", href: "/dashboard" },
           { label: article?.title || "Article" },
         ]}
         title={article?.title || "Article"}
         actions={
           article ? (
             <>
               <Button variant="outline" asChild>
                 <a href={article.url} target="_blank" rel="noopener noreferrer">
                   <ExternalLink className="mr-2 h-4 w-4" /> View Original
                 </a>
               </Button>
               <Button variant="outline" onClick={handleArchive} disabled={archiveMutation.isPending}>
                 {article.archived_at ? "Restore" : "Archive"}
               </Button>
             </>
           ) : undefined
         }
       />
       <PageLayout maxWidth="narrow" isLoading={isLoading} error={error ?? null}>
         {article && (
           <>
             {/* Article metadata */}
             {/* Article content with prose styling */}
           </>
         )}
       </PageLayout>
     </>
   )
   ```
7. Use `maxWidth="narrow"` — articles are long-form content that benefits from narrower reading width
8. Remove the "Back to Dashboard" ArrowLeft button
9. Remove the inline `<div className="min-h-screen bg-slate-50">` wrapper from the main content return
10. Keep all existing article content rendering, sanitized HTML, metadata display
  </action>
  <verify>
    - Run `npx tsc --noEmit` — no type errors
    - Grep for `Header` in projects/$id.tsx and articles/$articleId.tsx — no matches
    - Grep for `ArrowLeft` in these files — no matches
    - Grep for `min-h-screen bg-slate-50` in these files — no matches
    - Confirm breadcrumbs array in both files
  </verify>
  <done>
    Projects detail page uses PageLayout maxWidth=medium with breadcrumbs [Dashboard > Project Name]. Articles detail page uses PageLayout maxWidth=narrow with breadcrumbs [Dashboard > Article Title]. Both use PageLayout for loading/error states. No more inline wrappers or Header imports.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate Pin detail page and delete unused Header component</name>
  <files>
    src/routes/_authed/pins/$pinId.tsx
    src/components/layout/header.tsx
  </files>
  <action>
**Pin Detail (`src/routes/_authed/pins/$pinId.tsx`):**

1. Remove import of `Header` from `@/components/layout/header`
2. Remove import of `ArrowLeft` from lucide-react (if present)
3. Add imports:
   - `PageLayout` from `@/components/layout/page-layout`
   - `PageHeader` from `@/components/layout/page-header`
4. Remove `const { user } = Route.useRouteContext()`
5. Remove the 2 separate return blocks (loading, error) with `<div className="min-h-screen bg-slate-50"><Header />` wrappers
6. Replace with single return:
   ```tsx
   return (
     <>
       <PageHeader
         breadcrumbs={[
           { label: "Dashboard", href: "/dashboard" },
           { label: pin?.title || "Pin" },
         ]}
         title={pin?.title || "Pin Details"}
         actions={
           pin ? (
             <div className="flex gap-2">
               <Button variant="outline" onClick={() => setEditDialogOpen(true)}>
                 <Pencil className="mr-2 h-4 w-4" /> Edit
               </Button>
               <Button variant="outline" className="text-red-600" onClick={() => setDeleteDialogOpen(true)}>
                 <Trash2 className="mr-2 h-4 w-4" /> Delete
               </Button>
             </div>
           ) : undefined
         }
       />
       <PageLayout maxWidth="medium" isLoading={isLoading} error={error ?? null}>
         {pin && (
           <>
             {/* Error alert section (pin.error_message) */}
             {/* Pin image + metadata grid */}
             {/* Status section */}
             {/* Scheduling section */}
             {/* Metadata generation section */}
             {/* Publishing section */}
           </>
         )}
       </PageLayout>
       {/* Dialogs stay outside */}
       {pin && (
         <>
           <EditPinDialog ... />
           <DeletePinDialog ... />
           <MetadataHistoryDialog ... />
           <RegenerateFeedbackDialog ... />
         </>
       )}
     </>
   )
   ```
7. Use `maxWidth="medium"` for pin detail (consistent with project detail)
8. Remove the "Back to Dashboard" ArrowLeft button — breadcrumbs provide hierarchy navigation
9. Remove inline loading spinner and error state blocks
10. Remove the `<div className="min-h-screen bg-slate-50">` wrapper from the main content return
11. Keep all existing pin detail functionality: image display, metadata, status badge, error alert, scheduling section, generate metadata button, publish button, edit/delete dialogs, history dialog, feedback dialog

**Delete Header component:**

1. Delete `src/components/layout/header.tsx`
2. Verify no remaining imports of Header exist anywhere:
   ```bash
   grep -r "from '@/components/layout/header'" src/ --include="*.tsx" --include="*.ts"
   ```
   This should return zero results after all routes are migrated.
3. If any remaining imports found, they indicate an un-migrated route — do NOT delete header.tsx in that case, and fix the remaining import first.
  </action>
  <verify>
    - Run `npx tsc --noEmit` — no type errors
    - Run `npm run build` — successful build
    - Grep for `Header` import in all route files — no matches
    - Grep for `min-h-screen bg-slate-50` in all route files under _authed — no matches
    - Confirm `src/components/layout/header.tsx` does NOT exist (deleted)
    - Confirm pin detail page has breadcrumbs
  </verify>
  <done>
    Pin detail page uses PageLayout maxWidth=medium with breadcrumbs [Dashboard > Pin Title]. Header component deleted. All 5 authenticated routes now use the consistent PageLayout + PageHeader pattern with no duplicate wrapper code.
  </done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes with no errors
- `npm run build` succeeds
- All 5 route files under _authed/ use PageLayout (grep confirms)
- All 3 detail pages have breadcrumb navigation (grep for "breadcrumbs=" confirms)
- No file imports from `@/components/layout/header` (grep confirms)
- `src/components/layout/header.tsx` does not exist
- Container widths are consistent: wide for dashboard/calendar, medium for projects/pins, narrow for articles
- All existing functionality preserved: edit/delete dialogs, status management, scheduling, metadata generation, publishing
</verification>

<success_criteria>
All detail pages (Projects, Pins, Articles) migrated to PageLayout + PageHeader with breadcrumbs. Header component deleted. Complete elimination of duplicate page wrapper code across the entire application.
</success_criteria>

<output>
After completion, create `.planning/phases/09-consistent-ui-dashboard-layout/09-03-SUMMARY.md`
</output>
