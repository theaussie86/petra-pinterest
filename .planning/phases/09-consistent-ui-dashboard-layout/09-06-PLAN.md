---
phase: 09-consistent-ui-dashboard-layout
plan: 06
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/sidebar.tsx
  - src/components/layout/app-sidebar.tsx
  - src/routes/_authed.tsx
autonomous: false
gap_closure: true

must_haves:
  truths:
    - "Sidebar does not overlay main content — content is fully visible next to the sidebar"
    - "When sidebar collapses, main content expands to fill the freed space"
    - "Brand name displays 'PinMa' not 'Petra'"
    - "Menu items are visually centered with proper padding"
  artifacts:
    - path: "src/components/ui/sidebar.tsx"
      provides: "Sidebar primitive with layout that pushes content rather than overlaying"
    - path: "src/components/layout/app-sidebar.tsx"
      provides: "App sidebar with correct brand name and aligned menu items"
    - path: "src/routes/_authed.tsx"
      provides: "Auth layout wrapper with sidebar + main content in proper flex flow"
  key_links:
    - from: "src/routes/_authed.tsx"
      to: "src/components/ui/sidebar.tsx"
      via: "SidebarProvider flex container"
      pattern: "SidebarProvider"
    - from: "src/components/ui/sidebar.tsx"
      to: "main content"
      via: "spacer div width matches sidebar width"
      pattern: "w-\\[--sidebar-width\\]"
---

<objective>
Fix the sidebar layout so it participates in document flow instead of overlaying content, update brand name to "PinMa", and fix menu item alignment.

Purpose: Users reported across 4 UAT tests (1, 2, 5, 10) that the sidebar sits on top of main content, hiding the left portion. The brand name is wrong ("Petra" vs "PinMa") and menu items have alignment/padding issues.
Output: Sidebar layout that pushes content, correct branding, aligned menu items.
</objective>

<execution_context>
@/Users/cweissteiner/.claude/get-shit-done/workflows/execute-plan.md
@/Users/cweissteiner/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-consistent-ui-dashboard-layout/09-05-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix sidebar layout, brand name, and menu alignment</name>
  <files>src/components/ui/sidebar.tsx, src/components/layout/app-sidebar.tsx, src/routes/_authed.tsx</files>
  <action>
The shadcn/ui sidebar uses a spacer div + position:fixed pattern that is the canonical approach. However, user reports across 4 tests confirm content is hidden behind the sidebar. Debug and fix this.

**Diagnostic step (REQUIRED before any code changes):**
1. Run `npm run dev` and open the browser dev tools on a dashboard page
2. Inspect the DOM to verify the flex layout structure:
   - SidebarProvider wrapper div should have `display: flex`
   - Sidebar outer wrapper should be a flex child taking up ~16rem width
   - SidebarInset (main) should be the other flex child with `flex: 1`
3. Check if the spacer div's `w-[--sidebar-width]` resolves to an actual width value
4. Check if `--sidebar-width` CSS variable is set on the SidebarProvider wrapper

**If the spacer div has zero or incorrect width** (Tailwind v4 variable resolution issue):
- In `src/components/ui/sidebar.tsx`, the spacer div (around line 233-242) uses `w-[--sidebar-width]`. In Tailwind CSS v4, this syntax should resolve to `width: var(--sidebar-width)`. If it does NOT:
  - Try changing to explicit `w-[var(--sidebar-width)]` syntax
  - Or set `style={{ width: 'var(--sidebar-width)' }}` directly as inline style on the spacer div
  - Do the same for all `w-[--sidebar-width]` and `w-[--sidebar-width-icon]` usages in the Sidebar component (spacer div, fixed div, icon-collapsed states)

**If the spacer div has correct width but content still overlaps:**
- The flex layout may need explicit `overflow: hidden` or `overflow: auto` on the SidebarInset. Verify `min-w-0` is on SidebarInset (already added in 09-05).
- Check if any parent element (body, html, QueryClientProvider wrapper) is constraining or breaking the flex layout
- Ensure SidebarProvider's wrapper div `flex` class is not being overridden

**If the fixed sidebar is truly overlaying (not pushing):**
- As a last resort, change the sidebar from `position: fixed` to `position: sticky; top: 0; height: 100svh` on the inner sidebar div (line 243-254 area). This keeps it in flow while still being viewport-locked. Remove the spacer div if using sticky (sidebar itself provides the width). Update the collapsed states accordingly.

**Brand name fix:**
- In `src/components/layout/app-sidebar.tsx` line 55: Change `"Petra"` to `"PinMa"`

**Menu item alignment fix:**
- In `src/components/layout/app-sidebar.tsx`, adjust the SidebarHeader padding: the `px-2 py-4` on the brand div may need to be `px-4 py-4` for consistency
- For the nav items, ensure the SidebarMenuButton items have consistent left padding. The shadcn SidebarMenuButton should handle this, but if items appear misaligned, add `className="justify-start"` to the SidebarMenuButton or adjust the icon + text spacing

**IMPORTANT:** The sidebar.tsx is a shadcn/ui primitive. Make minimal, targeted changes. Do not rewrite the component. Focus on the specific CSS values that cause the overlay behavior.
  </action>
  <verify>
1. Run `npm run dev`
2. Open http://localhost:3000/dashboard in browser
3. Verify sidebar is visible on the left, main content is fully visible to the right of it (no overlap)
4. Collapse sidebar using the rail/trigger — main content should expand leftward to fill freed space
5. Expand sidebar — content should shift right again
6. Verify brand name shows "PinMa" not "Petra"
7. Verify menu items (Dashboard, Calendar) are aligned with proper padding
8. Navigate to /calendar — verify calendar content is not hidden behind sidebar
9. Run `npm run build` — no TypeScript errors
  </verify>
  <done>
- Sidebar sits alongside main content in flex layout — no overlay/overlap
- Collapsing/expanding sidebar causes main content to resize
- Brand name displays "PinMa"
- Menu items are properly aligned with consistent padding
- Calendar page content is fully visible
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Verify sidebar layout and branding</name>
  <action>User visually verifies the sidebar layout fixes, brand name change, and menu alignment.</action>
  <what-built>Fixed sidebar layout to not overlay content, changed brand from "Petra" to "PinMa", aligned menu items</what-built>
  <how-to-verify>
    1. Open http://localhost:3000/dashboard
    2. Verify the sidebar is on the left and main content is fully visible to its right (no content hidden)
    3. Click the sidebar rail/border to collapse — main content should expand to fill the space
    4. Click again to expand — content shifts right
    5. Verify "PinMa" appears as brand name in sidebar header
    6. Verify Dashboard and Calendar menu items look properly aligned
    7. Navigate to Calendar page — verify no content hidden behind sidebar
    8. Open a project detail page — verify no overlap
  </how-to-verify>
  <verify>User confirms sidebar layout works correctly</verify>
  <done>User approves sidebar layout, brand name, and menu alignment</done>
  <resume-signal>Type "approved" or describe remaining issues</resume-signal>
</task>

</tasks>

<verification>
- Sidebar does not overlay any page content (dashboard, calendar, project detail, article detail, pin detail)
- Sidebar collapse/expand resizes main content area
- Brand name is "PinMa"
- Menu items are aligned
- `npm run build` passes
</verification>

<success_criteria>
All 4 UAT gaps (tests 1, 2, 5, 10) are resolved: sidebar participates in layout flow, content adjusts to sidebar width changes, brand name correct, menu items aligned.
</success_criteria>

<output>
After completion, create `.planning/phases/09-consistent-ui-dashboard-layout/09-06-SUMMARY.md`
</output>
