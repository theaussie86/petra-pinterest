---
phase: 09-consistent-ui-dashboard-layout
plan: 08
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/layout/app-sidebar.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Sidebar header shows Pin icon + 'PinMa' text when expanded, only Pin icon when collapsed"
    - "Sidebar navigation items are centered and properly padded in both expanded and collapsed states"
    - "User avatar in footer is centered and properly sized in both expanded and collapsed states"
  artifacts:
    - path: "src/components/layout/app-sidebar.tsx"
      provides: "Collapse-aware sidebar header, properly wrapped navigation and footer menus"
      contains: "useSidebar"
  key_links:
    - from: "src/components/layout/app-sidebar.tsx"
      to: "src/components/ui/sidebar.tsx"
      via: "useSidebar hook import"
      pattern: "useSidebar"
---

<objective>
Fix two remaining sidebar UAT gaps: (1) sidebar header needs a logo icon that always shows and 'PinMa' text that hides when collapsed, (2) navigation items and footer avatar need SidebarGroup wrappers for proper padding and centering in both expanded and collapsed states.

Purpose: Close final UAT gaps from second round of user testing (tests 3 and 4).
Output: Updated app-sidebar.tsx with collapse-aware header and properly aligned menus.
</objective>

<execution_context>
@/Users/cweissteiner/.claude/get-shit-done/workflows/execute-plan.md
@/Users/cweissteiner/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/components/layout/app-sidebar.tsx
@src/components/ui/sidebar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix sidebar header collapse behavior and menu alignment</name>
  <files>src/components/layout/app-sidebar.tsx</files>
  <action>
    Make three targeted changes to src/components/layout/app-sidebar.tsx:

    **1. Import useSidebar and SidebarGroup:**
    - Add `useSidebar` to the import from `@/components/ui/sidebar`
    - Add `SidebarGroup` to the same import
    - Add `Pin` to the lucide-react import (for logo icon)

    **2. Collapse-aware header:**
    - Inside the component body, destructure: `const { state } = useSidebar()`
    - Replace the SidebarHeader content (currently a div with just "PinMa" text) with:
      ```tsx
      <SidebarMenu>
        <SidebarMenuItem>
          <SidebarMenuButton size="lg" asChild>
            <Link to="/dashboard">
              <div className="flex aspect-square size-8 items-center justify-center rounded-lg bg-primary text-primary-foreground">
                <Pin className="size-4" />
              </div>
              <div className="grid flex-1 text-left text-sm leading-tight">
                <span className="truncate font-semibold">PinMa</span>
              </div>
            </Link>
          </SidebarMenuButton>
        </SidebarMenuItem>
      </SidebarMenu>
      ```
    - This uses SidebarMenuButton size="lg" which has `group-data-[collapsible=icon]:!p-0`, causing the text to be hidden and only the icon square to show when collapsed. The shadcn sidebar primitive handles the collapse behavior automatically through `[&>span:last-child]:truncate` and the icon-mode sizing.

    **3. Wrap nav menu in SidebarGroup:**
    - In SidebarContent, wrap the existing `<SidebarMenu>` with `<SidebarGroup>`:
      ```tsx
      <SidebarContent>
        <SidebarGroup>
          <SidebarMenu>
            {navItems.map(...)}
          </SidebarMenu>
        </SidebarGroup>
      </SidebarContent>
      ```
    - SidebarGroup provides `p-2` padding which properly positions items and centers icons in collapsed mode.

    **4. Wrap footer menu in SidebarGroup and use size="lg":**
    - In SidebarFooter, wrap the existing `<SidebarMenu>` with `<SidebarGroup>`:
      ```tsx
      <SidebarFooter>
        <SidebarGroup>
          <SidebarMenu>
            <SidebarMenuItem>
              <DropdownMenu>
                <DropdownMenuTrigger asChild>
                  <SidebarMenuButton size="lg">
                    ...
                  </SidebarMenuButton>
                </DropdownMenuTrigger>
                ...
              </DropdownMenu>
            </SidebarMenuItem>
          </SidebarMenu>
        </SidebarGroup>
      </SidebarFooter>
      ```
    - Change footer SidebarMenuButton from default size to `size="lg"` â€” the lg variant adds `h-12` and `group-data-[collapsible=icon]:!p-0` which properly centers the avatar circle when collapsed (the `!p-0` removes padding so the 8x8 button centers the content).
    - Increase avatar from `h-6 w-6` to `h-8 w-8` and text from `text-[10px]` to `text-xs` to better fill the lg button size.

    **What NOT to change:**
    - Do NOT modify the dropdown menu content (sign out, user info)
    - Do NOT change the navItems array
    - Do NOT modify any other components or files
    - Do NOT remove the SidebarRail
  </action>
  <verify>
    Run `npm run build` to confirm no TypeScript errors. Visually confirm the changes are structurally correct by reading the file.
  </verify>
  <done>
    - SidebarHeader renders Pin icon (always visible) + 'PinMa' text (hidden when collapsed) using SidebarMenuButton size="lg" pattern
    - SidebarContent > SidebarMenu is wrapped in SidebarGroup for proper p-2 padding
    - SidebarFooter > SidebarMenu is wrapped in SidebarGroup with size="lg" on the menu button
    - useSidebar is imported (available for future use; collapse behavior handled by CSS via group-data selectors)
    - Build passes with no errors
  </done>
</task>

</tasks>

<verification>
- `npm run build` passes without errors
- app-sidebar.tsx imports: useSidebar, SidebarGroup, Pin (from lucide-react)
- SidebarHeader contains SidebarMenuButton with size="lg" and Pin icon
- SidebarContent > SidebarGroup > SidebarMenu structure
- SidebarFooter > SidebarGroup > SidebarMenu structure with size="lg" button
</verification>

<success_criteria>
- Build compiles cleanly
- Sidebar header shows logo icon that is always visible and text that hides on collapse (via shadcn CSS selectors, not JS conditional)
- Navigation items have proper padding from SidebarGroup wrapper
- Footer avatar is properly sized and centered in both states via size="lg" button
</success_criteria>

<output>
After completion, create `.planning/phases/09-consistent-ui-dashboard-layout/09-08-SUMMARY.md`
</output>
