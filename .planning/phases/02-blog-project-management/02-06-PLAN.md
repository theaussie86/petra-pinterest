---
phase: 02-blog-project-management
plan: 06
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/projects/delete-dialog.tsx
  - src/routes/_authed/projects/$id.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "After confirming delete on the project detail page, user is automatically navigated to /dashboard"
    - "Deleting a project from the dashboard does NOT navigate away (user stays on dashboard)"
    - "Delete still shows success toast and removes project from cache"
  artifacts:
    - path: "src/components/projects/delete-dialog.tsx"
      provides: "Optional onDeleted callback prop, called after successful deletion"
      contains: "onDeleted"
    - path: "src/routes/_authed/projects/$id.tsx"
      provides: "Navigation callback passed to DeleteDialog"
      contains: "useNavigate"
  key_links:
    - from: "src/components/projects/delete-dialog.tsx"
      to: "parent component"
      via: "onDeleted callback prop invoked after mutateAsync succeeds"
      pattern: "onDeleted\\?\\(\\)"
    - from: "src/routes/_authed/projects/$id.tsx"
      to: "/dashboard"
      via: "useNavigate() called inside onDeleted callback"
      pattern: "navigate.*dashboard"
---

<objective>
Fix post-delete navigation: after confirming project deletion on the project detail page, automatically navigate the user back to the dashboard.

Purpose: UAT Test 5 failed because DeleteDialog has no way to signal a successful deletion to the parent, and the project detail page never implemented navigation after delete.
Output: Updated DeleteDialog with optional onDeleted callback; project detail page passes navigation callback.
</objective>

<execution_context>
@/Users/cweissteiner/.claude/get-shit-done/workflows/execute-plan.md
@/Users/cweissteiner/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/components/projects/delete-dialog.tsx
@src/routes/_authed/projects/$id.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add onDeleted callback to DeleteDialog and wire navigation in project detail page</name>
  <files>src/components/projects/delete-dialog.tsx, src/routes/_authed/projects/$id.tsx</files>
  <action>
  Two changes:

  1. In `src/components/projects/delete-dialog.tsx`:
     - Add optional `onDeleted?: () => void` prop to `DeleteDialogProps` interface
     - In the `handleDelete` function, after the successful `mutateAsync` call and after `onOpenChange(false)`, call `onDeleted?.()`
     - The call order must be: await mutateAsync -> onOpenChange(false) -> onDeleted?.()
     - Do NOT change any other behavior. The mutation hook still handles toast and cache invalidation.

  2. In `src/routes/_authed/projects/$id.tsx`:
     - Import `useNavigate` from `@tanstack/react-router`
     - In the `ProjectDetail` component, call `const navigate = useNavigate()`
     - Pass `onDeleted` prop to the `DeleteDialog` component: `onDeleted={() => navigate({ to: '/dashboard' })}`
     - Do NOT pass onDeleted from the dashboard page (it doesn't use this component). The dashboard uses DeleteDialog separately without onDeleted, which is correct -- it's optional.

  Important: Do NOT modify `src/lib/hooks/use-blog-projects.ts`. Navigation is a UI concern, not a data layer concern. The hook's onSuccess (toast + invalidate) remains unchanged.
  </action>
  <verify>
  Run `npm run build` from the project root to confirm TypeScript compiles without errors.

  Then verify the code changes:
  - `delete-dialog.tsx` has `onDeleted?: () => void` in the interface
  - `delete-dialog.tsx` calls `onDeleted?.()` after successful deletion
  - `$id.tsx` imports `useNavigate` from `@tanstack/react-router`
  - `$id.tsx` passes `onDeleted` prop to DeleteDialog with navigate to `/dashboard`
  </verify>
  <done>
  DeleteDialog accepts optional onDeleted callback. Project detail page passes navigation callback. Build succeeds. Deleting a project from the detail page will navigate to /dashboard after success. Deleting from the dashboard (no onDeleted passed) continues working as before.
  </done>
</task>

</tasks>

<verification>
- `npm run build` passes with zero errors
- DeleteDialog interface includes `onDeleted?: () => void`
- DeleteDialog handleDelete calls `onDeleted?.()` after successful mutateAsync
- Project detail page imports useNavigate and passes onDeleted to DeleteDialog
- Dashboard page's DeleteDialog usage remains unchanged (no onDeleted prop)
</verification>

<success_criteria>
- TypeScript build succeeds
- DeleteDialog has onDeleted callback prop (optional, backward-compatible)
- Project detail page navigates to /dashboard after successful delete
- Dashboard delete behavior unchanged (no regression)
</success_criteria>

<output>
After completion, create `.planning/phases/02-blog-project-management/02-06-SUMMARY.md`
</output>
